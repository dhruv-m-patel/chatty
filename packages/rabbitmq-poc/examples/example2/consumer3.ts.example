import {MessageBroker, getMessageBroker, ConsumeMessage} from '../../MessageBroker';
import {handler, exchange2, exchange1} from './handler.ts.example';

const url = 'amqp://localhost';

function handler1 (msg: ConsumeMessage) {
    handler('handler 1', msg, interestingTopics);
}
function handler2 (msg: ConsumeMessage) {
    handler('handler 2', msg, interestingTopics);
}
const interestingTopics =['*.*.user.*', '*.highfive.*.updated']

async function init () {
    const consumer3: MessageBroker = await getMessageBroker(url);
    consumer3.consume(exchange2, interestingTopics, handler1);
    consumer3.consume(exchange1, interestingTopics, handler2);
}

init();
