import {MessageBroker, getMessageBroker, ConsumeMessage} from '../../MessageBroker';
import {handler, exchange1} from './handler.ts.example';

const url = 'amqp://localhost';
const interestingTopics1 = ['*.*.hfd.*', '*.*.note.added']
const interestingTopics2 = ['*.*.reaction.*']

function handler1 (msg: ConsumeMessage) {
    handler('handler 1', msg, interestingTopics1);

}
function handler2 (msg: ConsumeMessage) {
    handler('handler 2', msg, interestingTopics2);
}

async function init () {
    const consumer1: MessageBroker = await getMessageBroker(url);

    consumer1.consume(exchange1, interestingTopics1, handler1);
    consumer1.consume(exchange1, interestingTopics2, handler2)
}

init();
